<?phpuse \Swoole\Server;class AdminServer{    private $port = 9501;    private $host = '0.0.0.0';    private $server;    public function __construct()    {        echo swoole_get_local_ip()['ens33'].":".$this->port."\n";        $this->server = new Server($this->host,$this->port);        $this->onEvent();    }    public function onEvent(){        $this->server->on('connect',[$this,'connect']);        $this->server->on('receive',[$this,'receive']);        $this->server->on('close',[$this,'close']);    }    public function connect($server, $fd){        echo "Client:{$fd}Connect.\n";    }    public function receive($server, $fd, $from_id, $data){        echo '接收到机器的数据';        var_dump($data);        $data = json_decode($data,true);        $this->{$data['method']}($server, $fd, $from_id, $data);    }    public function machineInfo($server, $fd, $from_id, $data){        //TODO 处理数据        //返回        $server->send($fd,json_encode(['code'=>200,'msg'=>'return info ok']));    }    public function machineStop($server, $fd, $from_id, $data){        echo '去停止机器';      $return =   $this->sendToMachine('127.0.0.1',9556,json_encode($data));      //TODO 处理其他事情        echo '机器停止了';        $server->send($fd,json_encode(['code'=>200,'msg'=>'machine stop ok']));    }    public function sendToMachine($ip,$port,$data){        $client = new Swoole\Client(SWOOLE_SOCK_TCP);        if (!$client->connect($ip, $port, -1)) {            exit("connect failed. Error: {$client->errCode}\n");        }        $client->send($data);        $return =  $client->recv();        $client->close();        return $return;    }    public function close($server, $fd){        echo "Client:{$fd} Close.\n";    }    public function start(){        echo '启动后台服务';        $this->server->start();    }}(new AdminServer())->start();